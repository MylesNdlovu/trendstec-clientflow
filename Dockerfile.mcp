# Dockerfile for MT5 Playwright MCP Server
# This runs separately from the main Vercel deployment
FROM mcr.microsoft.com/playwright:v1.48.0-jammy

WORKDIR /app

# Copy MCP server files
COPY mcp-servers/mt5-playwright/package*.json ./
COPY mcp-servers/mt5-playwright/tsconfig.json ./
COPY mcp-servers/mt5-playwright/src ./src

# Install dependencies (including dev dependencies for build)
RUN npm install

# Build TypeScript (use npx to ensure tsc is found)
RUN npx tsc

# Remove dev dependencies after build to reduce image size
RUN npm prune --omit=dev

# Expose port for HTTP API (Render uses PORT env variable)
EXPOSE 10000

# Start the HTTP server (not stdio mode)
CMD ["node", "dist/http-server.js"]
